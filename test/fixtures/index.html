<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>plainview</title>
    <style media="screen">
      * { font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; }
    </style>
  </head>
  <body>

    <div>
      <h1>plainview</h1>
      <video id='video'></video><br />
      <progress id='playProgress' value="0" max="100">0%</progress><br />
      <progress id='downloadProgress' value="0" max="100">0%</progress><br />
      <button id='play' onclick='window.pv.play()' >Play</button>
      <button id='mute' onclick='window.pv.mute()'>Mute</button>
      <span id='time-code'></span>
    </div>

    <script src="http://localhost:1234/plainview.js" charset="utf-8"></script>
    <script type="text/javascript">
    (function() {

      var playProgressElem  = document.getElementById('playProgress')
      var progressElem      = document.getElementById('downloadProgress')
      var playElem          = document.getElementById('play')
      var muteElem          = document.getElementById('mute')
      var timecodeElem      = document.getElementById('time-code')

      const onPlayProgress = (percentDone, timecode) => {
        playProgressElem.value = percentDone
        timecodeElem.innerHTML = timecode
      }

      const onDownloadProgress = (percentDone) => { progressElem.value = percentDone }
      const onPlay   = () => { playElem.innerHTML = 'Pause'; playElem.setAttribute('onclick', 'window.pv.pause()') }
      const onPause  = () => { playElem.innerHTML = 'Play'; playElem.setAttribute('onclick', 'window.pv.play()') }
      const onEnded  = () => { playElem.innerHTML = 'Replay'; playElem.setAttribute('onclick', 'window.pv.replay()') }
      const onMute   = () => { muteElem.innerHTML = 'Unmute'; muteElem.setAttribute('onclick', 'window.pv.unmute()') }
      const onUnmute = () => { muteElem.innerHTML = 'Mute'; muteElem.setAttribute('onclick', 'window.pv.mute()') }

      let pv                = new plainview('http://0.0.0.0:8000/basic/krad.tv/tractor/vod.m3u8')
      pv.onPlayProgress     = onPlayProgress
      pv.onDownloadProgress = onDownloadProgress
      pv.onPlay             = onPlay
      pv.onPause            = onPause
      pv.onEnded            = onEnded
      pv.onMute             = onMute
      pv.onUnmute           = onUnmute

      pv.video  = document.getElementById('video')
      window.pv = pv
    })()
    </script>
  </body>
</html>
